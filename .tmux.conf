
# Robust tmux config for multiple versions
# This config auto-detects tmux version and applies settings accordingly

##### Prefix & Keybindings #####
unbind C-b
set -g prefix C-p
bind C-p send-prefix

unbind d
bind d detach

bind y setw synchronize-panes
bind v split-window -v
bind h split-window -h

bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

##### Appearance & Behavior #####
# Mouse support (version-specific)
if-shell 'tmux -V | awk "{split(\$2,a,\".\"); if(a[1]<2 || (a[1]==2 && a[2]<1)) exit 0; else exit 1}"' \
	"set -g mode-mouse on; set -g mouse-resize-pane on; set -g mouse-select-pane on; set -g mouse-select-window on" \
	"set -g mouse on"

# Pane border colors (tmux < 2.9 vs >= 2.9)
if-shell 'tmux -V | awk "{split(\$2,a,\".\"); if(a[1]>2 || (a[1]==2 && a[2]>=9)) exit 0; else exit 1}"' \
	"set -g pane-active-border-style fg=yellow" \
	"set -g pane-active-border-fg yellow"
set -s escape-time 500

##### Multicolor Status Bar #####
set -g status-bg green
set -g status-fg white

# Left section — Blue
set -g status-left "#[fg=black,bg=blue] ☰ #S #[default]"

# Right section — Green + Yellow
set -g status-right "#[fg=black,bg=green] #{prefix_highlight} #[fg=black,bg=yellow] %H:%M %d-%b #[default]"

# Window tabs
set -g window-status-format "#[fg=white,bg=blue] #I:#W #[default]"
set -g window-status-current-format "#[fg=brightyellow,bg=red,bold,underscore] #I:#W #[default]"

##### Plugins (may not fully work on 1.8) #####
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

set -g @prefix_highlight_show_copy_mode 'on'
set -g @prefix_highlight_prefix_prompt ' CTRL+P '
set -g @prefix_highlight_prefix_bg 'brightred'
set -g @prefix_highlight_prefix_fg 'white'
set -g @prefix_highlight_empty_bg 'green'
set -g @prefix_highlight_empty_fg 'black'

##### Initialize TPM (last!) #####
run '~/.tmux/plugins/tpm/tpm'
